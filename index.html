<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>遊べるお寺プロジェクト</title>
  <meta name="description" content="楽しく学び、遊んでつながる。遊べるお寺プロジェクトの公式サイト。イベント情報・活動報告・お問い合わせはこちら。" />
  <style>
    :root{
      --sky:#22a7ff;   /* アクセント青（ナビ下線） */
      --sand:#f7ce52;  /* 両脇の黄 */
      --ink:#2b2b2b;
      --paper:#fff;
      --maxw:1100px;
      --rail:16px;
    }
    @media(min-width:900px){ :root{ --rail:24px; } }

    /* ベース */
    html,body{ margin:0; padding:0; color:var(--ink); line-height:1.75; font-family:"Yu Gothic","Hiragino Kaku Gothic ProN",Meiryo,sans-serif; }
    body{ background:var(--sand); }
    .container{ max-width:var(--maxw); margin:0 auto; background:var(--paper); min-height:100vh; box-shadow:0 0 6px rgba(0,0,0,.05); }

    /* 視覚的にはサイト名を出さない（スクリーンリーダー用のみ） */
    header{ background:#fff; border-bottom:2px solid var(--sand); padding:0 var(--rail); }
    .visually-hidden{ position:absolute; left:-9999px; }

    /* ナビ（大きめ＋区切り線＋下に青ライン） */
    nav{ background:#fff; position:relative; border-bottom:2px solid var(--sand); }
    nav::after{ content:""; position:absolute; left:0; right:0; bottom:-2px; height:3px; background:var(--sky); }
    nav .wrap{
      max-width:var(--maxw); margin:0 auto; padding:0 var(--rail);
      display:flex; gap:0; justify-content:center; overflow:auto;
    }
    nav a{
      color:#333; text-decoration:none;
      padding:18px clamp(14px,2.6vw,28px);
      font-weight:700; font-size:clamp(18px,2.2vw,22px);
      white-space:nowrap; border-bottom:3px solid transparent;
    }
    nav a + a{ border-left:2px solid #ddd; }
    nav a:hover{ color:#111; background:#fafafa; }

/* ヒーロー */
.hero{
  margin:0;
  background:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:clamp(380px, 62vw, 760px);
  border-bottom:1px solid #eee;
}

.hero img{
  height:100%;        /* ← 高さをヒーローに合わせる */
  width:auto;         /* ← 横は自動（比率維持） */
  max-width:100%;
  object-fit:contain; /* ← 全体表示（左右切れ防止） */
  display:block;
  background:#fff;
  opacity:0;
  transition:opacity .6s ease;
}
.hero img.is-loaded{ opacity:1; }

/* スマホは縦長になりやすいので、幅基準に切替 */
@media (max-width:600px){
  .hero{ height:clamp(260px, 60vw, 420px); }
  .hero img{
    width:100%;
    height:auto;
  }
}



    /* 本文 */
    main{ padding:28px var(--rail) 56px; }
    h2{ margin:.2em 0 .5em; font-size:clamp(20px,2.8vw,26px); }
    .lead{ margin:0 0 1rem; opacity:.9; }

    /* コラボ募集 */
    .collab{ margin:28px 0 8px; }
    .collab-inner{
      background:#2f7d3a; color:#fff; border-radius:20px;
      padding:clamp(20px,3vw,36px); display:grid; gap:clamp(16px,2.5vw,28px); align-items:center;
      box-shadow:0 8px 20px rgba(0,0,0,.12);
    }
    .collab-media img{ width:100%; max-width:360px; display:block; margin:0 auto; border-radius:12px; }
    .collab-copy h2{ margin:0 0 .6em; font-size:clamp(22px,3.6vw,34px); }
    .collab-copy p{ margin:0 0 1.1em; font-size:clamp(15px,2.4vw,17px); opacity:.95; }
    .collab-btn{ display:inline-block; background:#7ee081; color:#0b3d0f; text-decoration:none; font-weight:700; padding:.9rem 1.6rem; border-radius:999px;
      box-shadow:0 6px 0 rgba(0,0,0,.12), 0 12px 22px rgba(0,0,0,.18); transition:transform .04s ease, filter .15s ease; }
    .collab-btn:hover{ filter:brightness(.96); }
    .collab-btn:active{ transform:translateY(1px); }
    @media(min-width:880px){ .collab-inner{ grid-template-columns:380px 1fr; padding:clamp(28px,4vw,44px);} }

    /* フッター */
    footer{ background:#f7f7f7; border-top:1px solid #eee; padding:14px var(--rail); text-align:center; font-size:.9rem; color:#666; }
  </style>
</head>
<body>
  <div class="container">
    <header><span class="visually-hidden">遊べるお寺プロジェクト</span></header>

    <!-- ナビ -->
    <nav aria-label="主なナビゲーション">
      <div class="wrap">
        <a href="/">ホーム</a>
        <a href="/project/">プロジェクト</a>
        <a href="/events/">イベント</a>
        <a href="https://note.com/loyal_dill1011" target="_blank" rel="noopener">活動報告（note）</a>
        <a href="/contact/">お問い合わせ</a>
      </div>
    </nav>

    <!-- ヒーロー（ランダム月別表示） -->
    <figure class="hero">
      <img id="hero-image" alt="季節のメインビジュアル">
    </figure>

    <main>
      <section>
        <h2>遊べるお寺プロジェクトとは</h2>
        <p class="lead">
          「楽しい」、「面白い」、「ワクワクする」、そんな気持ちを土台として、遊びや対話を通じてつながっていく——そんな自由で開かれた雰囲気を大切にしています。<br><br>
          現代社会では、地域や世代を超えたつながりが希薄になり、自分の属する団体や興味関心のある小さなコミュニティの中だけで暮らすことが当たり前になりつつあります。<br><br>
          そのような時代において、価値観の異なる他者と自然に出会い、交わることができる「場」が作れたらと思い活動しています。
        </p>
      </section>




      

<!-- ===== note 最新3件（横並び）ここから ===== -->
<section id="note-latest" class="section">
  <h2 class="section-title">最新のnote</h2>
  <div id="note-grid-latest" class="note-grid"></div>
  <div class="note-actions">
    <a class="btn-more" href="./note/index.html">もっと読む</a>
  </div>
</section>

<style>
/* noteカード部分のスタイル */
.note-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 900px) { .note-grid { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 640px) { .note-grid { grid-template-columns: 1fr; } }

.note-card { background: #fff; border-radius: 14px; overflow: hidden;
  box-shadow: 0 6px 18px rgba(0,0,0,.08); transition: transform .15s, box-shadow .15s; }
.note-card:hover { transform: translateY(-3px); box-shadow: 0 10px 22px rgba(0,0,0,.12); }

.note-thumb-wrap { aspect-ratio: 16/9; background:#f3f3f3; overflow:hidden; }
.note-thumb { width:100%; height:100%; object-fit:cover; display:block; }

.note-meta { padding: .9rem .95rem 1rem; }
.note-title { font-size: 1rem; line-height: 1.5; margin: 0 0 .35rem; }


<!-- head内のどこか（できれば<title>の下）に追加 -->
<meta http-equiv="Content-Security-Policy"
  content="default-src 'self';
           connect-src 'self' https://r.jina.ai;
           img-src 'self' https: data:;
           script-src 'self' 'unsafe-inline' https:;
           style-src 'self' 'unsafe-inline' https:;">




  
.note-date { font-size: .85rem; color: #666; }

.note-actions { text-align: center; margin-top: 1rem; }
.btn-more { display:inline-block; padding:.7rem 1.2rem; border-radius:999px;
  background:#F4B400; color:#222; font-weight:700; text-decoration:none;
  box-shadow:0 4px 12px rgba(244,180,0,.35); }
</style>
<!-- ===== note 最新3件（横並び）ここまで ===== -->



<script>
(function(){
  const GRID_ID = "note-grid-latest";
  const LIMIT = 3;
  const RSS_URL = "https://r.jina.ai/http/note.com/loyal_dill1011/rss"; // CORS回避

  // ---- 安全ガード：グリッドが無ければ何もしない
  const grid = document.getElementById(GRID_ID);
  if (!grid) { console.warn("[note] grid not found"); return; }

  // ---- ユーティリティ
  const abs = (u) => {
    if (!u) return "";
    if (u.startsWith("http")) return u;
    if (u.startsWith("//")) return "https:" + u;
    if (u.startsWith("/"))  return "https://note.com" + u;
    return u;
  };
  const decodeHTML = (html) =>
    new DOMParser().parseFromString(html || "", "text/html").documentElement.textContent || "";

  const firstImgFromHTML = (html) => {
    const decoded = decodeHTML(html);
    const doc = new DOMParser().parseFromString(decoded, "text/html");
    const img = doc.querySelector("img");
    if (!img) return "";
    return abs(img.getAttribute("src") || img.getAttribute("data-src") || img.getAttribute("data-original"));
  };

  const fallbackImg = "https://assets.st-note.com/production/uploads/images/default/ogp.png";

  const renderCard = ({title, link, date, img}) => {
    grid.insertAdjacentHTML("beforeend", `
      <article class="note-card">
        <a class="note-link" href="${link}" target="_blank" rel="noopener">
          <div class="note-thumb-wrap">
            <img class="note-thumb" src="${img}" alt="${title}" loading="lazy" referrerpolicy="no-referrer">
          </div>
          <div class="note-meta">
            <h3 class="note-title">${title}</h3>
            <time class="note-date">${date}</time>
          </div>
        </a>
      </article>
    `);
  };

  async function main(){
    try {
      const res = await fetch(RSS_URL);
      if (!res.ok) throw new Error("RSS fetch " + res.status);
      const xml = new DOMParser().parseFromString(await res.text(), "text/xml");
      const items = Array.from(xml.querySelectorAll("item")).slice(0, LIMIT);

      if (!items.length) {
        grid.innerHTML = '<p style="color:#666">記事が見つかりませんでした。</p>';
        return;
      }

      for (const it of items) {
        const title = it.querySelector("title")?.textContent ?? "";
        const link  = it.querySelector("link")?.textContent ?? "#";
        const pub   = it.querySelector("pubDate")?.textContent ?? "";
        const date  = pub ? new Date(pub).toLocaleDateString("ja-JP") : "";

        // 画像の拾い順：enclosure → media:* → content:encoded → description → デフォルト
        let img = it.querySelector("enclosure")?.getAttribute("url")
               || it.querySelector("media\\:thumbnail")?.getAttribute("url")
               || it.querySelector("media\\:content")?.getAttribute("url")
               || "";

        if (!img) {
          const contentNode = it.querySelector("content\\:encoded");
          img = firstImgFromHTML(contentNode?.textContent || "");
        }
        if (!img) {
          img = firstImgFromHTML(it.querySelector("description")?.textContent || "");
        }
        img = abs(img || fallbackImg);

        renderCard({title, link, date, img});
      }
    } catch (e) {
      console.error("[note] error:", e);
      grid.innerHTML = '<p style="color:#c00">noteの読み込みに失敗しました。</p>';
    }
  }
  main();
})();
</script>






      



      


      <!-- コラボ募集 -->
      <section class="collab">
        <div class="collab-inner">
          <div class="collab-media">
            <img src="/images/collab-badge.png" alt="コラボ募集イメージ">
          </div>
          <div class="collab-copy">
            <h2>コラボ・講師依頼のご案内</h2>
            <p>
              遊べるお寺プロジェクトでは、地域・学校・福祉施設・企業などでのコラボ企画や講師依頼を承っております。<br><br>
              健康麻雀や座禅体験、サバイバルゲーム、ボードゲームなど、多彩なプログラムを通じて、人と人が自然につながる場をつくります。<br><br>
              出張企画やご相談は、お問い合わせフォームよりご連絡ください。
            </p>
            <a class="collab-btn" href="/contact/">お問い合わせはこちら</a>
          </div>
        </div>
      </section>
    </main>

    <footer>© 2025 遊べるお寺プロジェクト</footer>
  </div>

  <!-- 月別フォルダからランダム表示（10月= /images/top/10/） -->
<script>
(function(){
  // 今月の数字（例: 10月 -> "10"）
  const month = String(new Date().getMonth() + 1).padStart(2, '0');

  // フォルダ（10月は '/images/top/10/'）
  const folder = `/images/top/${month}/`;

  // ✅ 用意したバナー5枚（ここを4→5に）
  const baseNames = ['banner1','banner2','banner3','banner4','banner5'];
  const exts = ['webp','png','jpg']; // 優先順で解決

  const heroImg = document.getElementById('hero-image');

  // 候補URLを順にプリフライトして、存在するものだけに絞る
  Promise.all(baseNames.map(resolveExisting))
    .then(list => list.filter(Boolean))
    .then(valid => {
      if (valid.length === 0) throw new Error('候補画像が見つかりません');
      const pick = valid[Math.floor(Math.random() * valid.length)];
      const pre = new Image();
      pre.onload = () => {
        heroImg.src = pick;
        heroImg.classList.add('is-loaded'); // フェードイン
      };
      pre.onerror = () => fallback();
      pre.src = pick;
    })
    .catch(fallback);

  function resolveExisting(base){
    return new Promise(resolve => {
      let i = 0;
      const tryNext = () => {
        if (i >= exts.length) return resolve(null);
        const url = `${folder}${base}.${exts[i++]}`;
        const img = new Image();
        img.onload = () => resolve(url);
        img.onerror = tryNext;
        img.src = url + '?v=1'; // キャッシュ抑制
      };
      tryNext();
    });
  }

  function fallback(){
    // 任意のデフォルト（無ければ何もしない）
    // heroImg.src = '/images/cover.png';
    heroImg.classList.add('is-loaded');
    console.warn('月別ランダム画像の表示に失敗しました。パスとファイル名をご確認ください。');
  }
})();
</script>



  
</body>
</html>
